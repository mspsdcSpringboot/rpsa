<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:insert="~{layout/headerFooterDynamicLayout.html}">
<main th:fragment = "content">
<!--    <div class="container mt-5">-->
<!--        <div class="row justify-content-center">-->
<!--            <div class="col-md-6 mb-5 mb-md-0">-->
<!--                <div class="shadow-lg p-4 wow">-->
<!--                    <div class="form-group mb-3">-->
<!--                        <h5 class="text-center"><strong>Instruction</strong></h5>-->
<!--                        <hr />-->
<!--                    </div>-->
<!--                    <br>-->
<!--                    <div class="form-group">-->
<!--                        <p th:text="${appeallist.forwardremarks}"></p>-->
<!--                    </div>-->
<!--                    <br />-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

    <br />

    <div class="container mt-5">
        <div class="container-fluid shadow-lg p-4 wow">
            <!-- Toggle Button with Icon -->
            <div class="d-flex align-items-center" style="cursor: pointer;" data-bs-toggle="collapse" data-bs-target="#viewAppeal" aria-expanded="false" aria-controls="viewAppeal">
                <i class="fas fa-plus-circle me-2" id="toggleIcon"></i>
                <h4 class="mb-0"><b>View Appeal</b></h4>
            </div>
            <hr class="my-2" />

            <!-- Collapsible Card for View Appeal -->
            <div class="toggle" id="viewAppeal">
                <div class="card shadow-lg mb-4">
                    <div class="card-body p-4">
                        <!-- Heading -->
                        <h4 class="text-center mb-4"><b>View Appeal</b></h4>

                        <table class="table table-bordered">
                            <!-- Service Name -->
                            <tr>
                                <th><strong>Service Name:</strong></th>
                                <td th:text="${appeallist.subservicecode.subservicename}"></td>
                            </tr>

                            <!-- Designated Officer -->
                            <tr>
                                <th><strong>Designated Officer:</strong></th>
                                <td th:text="${appeallist.officeid.officename}"></td>
                            </tr>

                            <!-- Relief Sought -->
                            <tr>
                                <th><strong>Relief Sought:</strong></th>
                                <td th:text="${appeallist.relief1}"></td>
                            </tr>

                            <!-- Other Information -->
                            <tr>
                                <th><strong>Other information necessary for filling appeal:</strong></th>
                                <td th:text="${appeallist.otherinfo1}"></td>
                            </tr>

                            <!-- Identification Proof -->
                            <tr>
                                <th><strong>Identification Proof:</strong></th>
                                <td>
                                    <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewidproof/{appealcode}(appealcode=${appeallist.appealcode})}">View</a>
                                </td>
                            </tr>

                            <!-- Supporting Documents -->
                            <tr>
                                <th><strong>List of Supporting documents:</strong></th>
                                <td>
                                    <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewsupportdoc/{appealcode}(appealcode=${appeallist.appealcode})}">View Document</a>
                                    <div th:if="${appeallist.supportdoc2 != null}">
                                        <br />
                                        <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewsupportdoc2/{appealcode}(appealcode=${appeallist.appealcode})}">View Document</a>
                                    </div>
                                    <div th:if="${appeallist.supportdoc3 != null}">
                                        <br />
                                        <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewsupportdoc3/{appealcode}(appealcode=${appeallist.appealcode})}">View Document</a>
                                    </div>
                                </td>
                            </tr>

                            <!-- Order Copy -->
                            <tr>
                                <th><strong>Copy of the Order:</strong></th>
                                <td>
                <span th:if="${appeallist.ordercopy != null}">
                    <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewordercopy/{appealcode}(appealcode=${appeallist.appealcode})}">View</a>
                </span>
                                    <span th:unless="${appeallist.ordercopy != null}">Not Uploaded</span>
                                </td>
                            </tr>

                            <!-- Hearing Type -->
                            <tr>
                                <th><strong>Hearing Type:</strong></th>
                                <td>
                                    <div th:if="${appeallist.hearingtype == '1'}">In Person</div>
                                    <div th:if="${appeallist.hearingtype == '2'}">Online</div>
                                    <input type="hidden" id="hearingtype" th:value="${appeallist.hearingtype}" />
                                </td>
                            </tr>

                            <!-- FORM I -->
                            <tr>
                                <th><strong>FORM I:</strong></th>
                                <td>
                                    <a class="btn btn-outline-primary btn-sm" target="_blank" th:href="@{/secure/viewform1/{appealcode}(appealcode=${appeallist.appealcode})}">View</a>
                                </td>
                            </tr>

                            <!-- View Application Details -->
                            <tr>
                                <th><strong>View Application Details:</strong></th>
                                <td>
<!--                                    <a class="btn btn-outline-primary btn-sm" th:href="@{'viewapplicationdetails.htm?referenceNo=' + ${appeallist.applicationrefno} + '&submissionDate=' + ${#dates.format(appeallist.applicationdate, 'dd/MM/yyyy') }}" target="_blank">View</a>-->
                                    <a class="btn btn-outline-primary btn-sm" th:href="@{'/secure/viewKhadcApplicationDetails?referenceNo=' + ${appeallist.applicationrefno} + '&submissionDate=' + ${#dates.format(appeallist.applicationdate, 'dd/MM/yyyy')}}"
                                       target="_blank">View Application Details</a>
                                </td>
                            </tr>
                        </table>
                    </div>


                </div>
            </div>
        </div>

    </div>

    <div class="container mt-5" id="Current">
        <div class="row justify-content-center">
            <div class="col-md-12 mb-5 mb-md-0">
                <div class="shadow-lg p-4 wow">
                    <!-- Toggle Button for Collapsible Section -->
                    <div class="d-flex align-items-center" style="cursor: pointer;" data-bs-toggle="collapse" data-bs-target="#transactionTable" aria-expanded="false" aria-controls="transactionTable">
                        <i class="fas fa-plus-circle me-2" id="toggleTransactionIcon"></i>
                        <h4 class="mb-0"><b>Process History</b></h4>
                    </div>
                    <hr class="my-2" />

                    <!-- Collapsible Table Section -->
                    <div class="collapse" id="transactionTable">
                        <div class="form-group">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Process Details</th>
                                    <th>Action Taken Date</th>
                                    <th>Action Taken By</th>
                                    <th>Other Details</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="d : ${transactionlist}">
                                    <td th:text="${d.transactiondetails}"></td>
                                    <td>
                                        <span th:text="${#dates.format(d.transactiondate, 'yyyy-MM-dd')}"></span>
                                    </td>
                                    <td th:text="${d.usercode.fullname}"></td>
                                    <td>
                                        <div th:if="${d.actioncode.actioncode == '1'}">
                                            Hearing Date: <span th:text="${#dates.format(d.hearingdate, 'yyyy-MM-dd')}"></span><br />
                                            Hearing Time: <span th:text="${d.hearingtime}"></span>
                                            <div th:if="${appeallist.hearingtype == '2'}">
                                                <br />
                                                <label><strong>VC Link: </strong></label> <span th:text="${appeallist.link1}"></span>
                                            </div>
                                            <div th:if="${appeallist.hearingtype != '2'}">
                                                <br />
                                                <label><strong>Hearing Venue:</strong></label>
                                                <span th:text="${appeallist.venue1}">Details about the in-person hearing</span>
                                            </div>
                                        </div>
                                        <div th:if="${d.actioncode.actioncode == '2' or d.actioncode.actioncode == '3'}">
                                            <span th:text="${d.remarks}"></span><br />
                                            <div th:if="${#strings.length(d.orderdoc) > 0}">
                                                <a th:href="@{'vieworderdoc.htm?tcode=' + ${d.transactionscode}}" target="_blank">View Order Document</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div> <!-- End of collapsible section -->
                </div>
            </div>
        </div>
    </div>


    <div class="container">
        <div class="row justify-content-end text-center mt-3">
            <div class="col-md-4 mb-2"> <!-- Adjusted to col-md-3 -->
                <button class="btn btn-success btn-lg w-100" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasForm" aria-controls="offcanvasForm">
                    <i class="bi bi-check-circle"></i>
                    Take Action
                </button>
            </div>
        </div>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasForm" aria-labelledby="offcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasLabel">Process Appeal</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="shadow-lg p-4 wow" th:if="${appeallist.forwardremarks != null}">
                <div class="form-group mb-3">
                    <h5 class="text-center"><strong>Instruction</strong></h5>
                    <hr />
                </div>
                <br>
                <div class="form-group">
                    <p th:text="${appeallist.forwardremarks}"></p>
                </div>
                <br />
            </div>


            <br>
            <div class="shadow-lg p-4 wow">
                <form id="fprocessappeal" enctype="multipart/form-data">

                    <input type="hidden" th:value="${userData.usercode}" />

                    <div class="form-group mb-3">
                        <h5 class="text-center"><strong>Process Appeal</strong></h5>
                        <hr />
                    </div>
                    <br/>

                    <div class="form-check">
                        <div th:each="d : ${maction}">
                            <!-- Check for action code '3' -->
                            <div th:if="${d.actioncode == '3'}">
                                <input type="radio" th:name="forwardactioncode" th:value="${d.actioncode}" id="dispose" class="actions dispose" />
                                <label class="form-check-label disposelabel" for="dispose" th:text="${d.actions}"></label>
                                <br />
                            </div>

                            <!-- Check for action code '9' -->
                            <div th:if="${d.actioncode == '9'}">
                                <input type="radio" th:name="forwardactioncode" th:value="${d.actioncode}" hidden="true" id="penalty" class="actions dispose" />
                                <label hidden="true" class="form-check-label disposelabel" for="penalty" th:text="${d.actions}"></label>
                                <br />
                            </div>

                            <!-- Default case for all other action codes -->
                            <div th:unless="${d.actioncode == '3' || d.actioncode == '9'}">
                                <input type="radio" th:name="forwardactioncode" th:value="${d.actioncode}" class="actions dontdispose" id="action-${d.actioncode}" />
                                <label class="form-check-label dontdisposelabel" th:for="'action-' + ${d.actioncode}" th:text="${d.actions}"></label>
                                <br />
                            </div>
                        </div>
                    </div>

                    <br />
                    <div id="rejectaction">
                        <div class="form-group">
                            <label>Remarks:</label><br>
                            <select id="selectremarks" name="remarks" class="form-select">
                                <option value="">Select</option>
                                <div th:each="d : ${remarkslist}">
                                    <option th:value="${d.remarksid}" th:text="${d.remarks}"></option>
                                </div>
                                <option value="0">Others</option>
                            </select>
                            <textarea class="form-control" name="remarkstxt" id="remarks" placeholder="Please enter remarks"></textarea>
                            <br>
                        </div>
                        <br>
                        <div class="form-group">
                            <label>Upload Signed & Sealed Order: </label><br>
                            <input type="file" id="file1" name="file1" />
                            <br>
                        </div>
                    </div>

                    <br />
                    <div class="form-group" id="rejected">
                        <label th:text="${#dates.format(fprocessappeal.forwarddate, 'yyyy-MM-dd')}"></label>
                        <br />
                        <br />
                    </div>

                    <br />
                    <div class="form-group callforhearingaction" id="callforhearingaction">
                        <label>Hearing Date:</label><br>
                        <input type="date" name="firsthearingdate" class="form-control dates" id="hearingdate" />
                        <input type="hidden" th:field="${fprocessappeal.hearingtype}" class="form-control dates" name="hearingtype"/>
                    </div>
                    <br />
                    <div class="form-group callforhearingaction">
                        <div class="row">
                            <div class="col-6">
                                Hearing Start Time:
                                <input type="time" name="hearingtime1" class="form-control dates" id="hearingtime1" />
                            </div>
                            <div class="col-6">
                                Hearing End Time:
                                <input type="time" name="hearingendtime1" class="form-control dates" id="hearingtime2" />
                            </div>
                        </div>
                    </div>
                    <br />
                    <div class="form-group" id="offline">
                        <label for="venue">Hearing Venue:</label>
                        <input type="text" name="venue1" class="form-control dates" id="venue" placeholder="Enter Hearing Venue" />
                    </div>
                    <br />
                    <div class="row">
                        <div class="col text-center">
                            <input type="hidden" id="appealCodes" th:value="${appeallist.appealcode}" />
                            <button type="submit" id="submitprocessbtn" class="btn btn-primary">Submit</button>
                            <a href="#" class="btn btn-danger">Back</a>
                        </div>
                    </div>
                    <br>
                </form>
            </div>

        </div>
    </div>



    <style>
        .offcanvas-end {
           width: 800px;
        }
        .btn {
            transition: background-color 0.3s, transform 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

    </style>

    <script th:src="@{/web/js/jsfiles/viewf.js}" type="text/javascript"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    </body>

</main>
</html>